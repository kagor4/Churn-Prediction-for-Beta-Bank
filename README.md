# –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ ¬´–ë–µ—Ç–∞-–ë–∞–Ω–∫–∞¬ª

–ú–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —É—Ö–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ ¬´–ë–µ—Ç–∞-–ë–∞–Ω–∫–∞¬ª.  
–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –≤—ã–≥–æ–¥–Ω–µ–µ, —á–µ–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö.

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

- –°–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å, —É–π–¥—ë—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç –∏–∑ –±–∞–Ω–∫–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –î–æ—Å—Ç–∏—á—å –∑–Ω–∞—á–µ–Ω–∏—è *F1*-–º–µ—Ä—ã –Ω–µ –º–µ–Ω–µ–µ 0.59
- –ò–∑–º–µ—Ä–∏—Ç—å –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É *AUC-ROC* —Å *F1*-–º–µ—Ä–æ–π
- –í—ã—è–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.x
- pandas, numpy, matplotlib, seaborn, sklearn
- DecisionTreeClassifier, RandomForestClassifier, LogisticRegression
- StandardScaler, OrdinalEncoder, train_test_split
- –ú–µ—Ç—Ä–∏–∫–∏: f1_score, roc_auc_score, accuracy_score, precision_score, recall_score
- Jupyter Notebook

## üß™ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/kagor4/Churn-Prediction-for-Beta-Bank.git
cd Churn-Prediction-for-Beta-Bank
pip install -r requirements.txt
```

–ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `projectgithub_update2.py` –∏–ª–∏ –Ω–æ—É—Ç–±—É–∫ —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –∫–æ–¥–æ–º –≤ Jupyter. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç–∞—Å–µ—Ç `Churn.csv` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø–∞–ø–∫–µ `/datasets/`.

## üìä –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤:
- **Churn.csv**:
  - `RowNumber` ‚Äî –∏–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏ (—É–¥–∞–ª—ë–Ω)
  - `CustomerId` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
  - `Surname` ‚Äî —Ñ–∞–º–∏–ª–∏—è (—É–¥–∞–ª–µ–Ω–∞)
  - `CreditScore` ‚Äî –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
  - `Geography` ‚Äî —Å—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è (France, Germany, Spain)
  - `Gender` ‚Äî –ø–æ–ª (Male, Female)
  - `Age` ‚Äî –≤–æ–∑—Ä–∞—Å—Ç
  - `Tenure` ‚Äî —Å—Ç–∞–∂ –∫–ª–∏–µ–Ω—Ç–∞ (–ª–µ—Ç)
  - `Balance` ‚Äî –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á—ë—Ç–µ
  - `NumOfProducts` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–∞–Ω–∫–∞
  - `HasCrCard` ‚Äî –Ω–∞–ª–∏—á–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã (0/1)
  - `IsActiveMember` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ (0/1)
  - `EstimatedSalary` ‚Äî –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞
  - `Exited` ‚Äî —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ (0 ‚Äî –æ—Å—Ç–∞–ª—Å—è, 1 ‚Äî —É—à—ë–ª)
- **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**:
  - –ü—Ä–æ–ø—É—Å–∫–∏ –≤ `Tenure` –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
  - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`Geography`, `Gender`) –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥–æ–º one-hot encoding
  - –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é StandardScaler
  - –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã (`RowNumber`, `Surname`)

## üîç –ö—Ä–∞—Ç–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å**: RandomForestClassifier (—Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –≤—ã–±–æ—Ä–∫–∏)
- **–ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ**:
  - *F1*-–º–µ—Ä–∞: 0.61 (—Ü–µ–ª—å ‚â• 0.59 –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞)
  - *ROC AUC*: 0.85
  - Accuracy: 0.82
  - Precision: 0.57
  - Recall: 0.66
- **–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã** (–ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):
  - `Age`, `Balance`, `NumOfProducts`, `IsActiveMember` ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ
  - –ú–µ–Ω—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ: `CreditScore`, `EstimatedSalary`
- **–ú–µ—Ç–æ–¥—ã –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º**:
  - –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ (`class_weight='balanced'`)
  - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ (upsampling, repeat=4)
  - –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ (downsampling, fraction=0.3)
- **–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã**:
  - RandomForestClassifier —Å upsampling –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É Precision –∏ Recall
  - –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (80% ‚Äî –æ—Å—Ç–∞–ª–∏—Å—å, 20% ‚Äî —É—à–ª–∏) —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏
  - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –∏ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–∞—é—Ç —Å—Ö–æ–∂–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –Ω–æ upsampling –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –∏–∑-–∑–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–≥–æ Recall
  - LogisticRegression –ø–æ–∫–∞–∑–∞–ª–∞ —Ö—É–¥—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (F1 ‚âà 0.28‚Äì0.49)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RandomForestClassifier —Å upsampling –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
  - –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –∏ –≤–æ–∑—Ä–∞—Å—Ç–æ–º
  - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–∞—Å—Ç–æ—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
  - –ü—Ä–æ–≤–µ—Å—Ç–∏ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–ª–∏—è–Ω–∏—è —É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –º–µ—Ä

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üì¶ Churn-Prediction-for-Beta-Bank/
‚îú‚îÄ‚îÄ projectgithub_update2.ipynb  # –∞–Ω–∞–ª–∏–∑ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ requirements.txt             # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                    # –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

## ‚úÖ TODO

- –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, XGBoost, CatBoost)
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ SHAP –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é ROC-–∫—Ä–∏–≤—ã—Ö –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

## ¬© –ê–≤—Ç–æ—Ä

–ê–≤—Ç–æ—Ä: [kagor4](https://github.com/kagor4)  
